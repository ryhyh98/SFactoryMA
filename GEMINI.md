# 스마트공장 수준 진단 애플리케이션 개발 일지

## 프로젝트 목표

사용자의 요구사항에 따라 스마트공장 수준을 진단하는 웹 기반 설문 애플리케이션을 개발하고, 최종적으로 사용자가 쉽게 실행할 수 있는 실행 파일(.exe) 형태로 패키징한다.

---

## 개발 과정 요약

### 1. 초기 요구사항 분석 및 기획

- **`sfactory_기준.txt` 분석**: 사용자의 초기 요구사항을 분석하여 기능 목록을 정의했습니다.
- **`PRD.md` 작성**: 분석된 내용을 바탕으로 제품 요구사항 문서(PRD)를 작성하여 개발의 기반을 마련했습니다.

### 2. 웹 애플리케이션 개발

- **개발 환경 설정**: Python Flask 프레임워크를 기반으로 프로젝트를 설정하고, `pandas` 라이브러리를 추가하여 CSV 데이터를 처리하도록 했습니다.
- **핵심 기능 구현 (`app.py`, `templates/index.html`):
    - `스마트팩토리수준진단_input.csv` 파일을 읽어 설문 문항을 동적으로 생성했습니다.
    - 2가지 기준(점수1, 점수2)에 따른 복잡한 점수 계산 로직을 구현했습니다.
    - 설문 완료 후, 응답자 정보를 `설문자리스트.xlsx` 파일에, 전체 결과는 고유 일련번호를 가진 `.json` 파일에 저장하는 기능을 구현했습니다.

### 3. 기능 고도화 및 디버깅

- **결과 페이지 개선**: 단순 텍스트 형태의 결과 페이지를 사용자가 제공한 `스마트공장수준진단결과.jpg` 이미지와 동일한 레이아웃으로 개선했습니다.
    - Chart.js 라이브러리를 도입하여 영역별 수준을 보여주는 막대그래프를 추가했습니다.
    - 최종 수준(Level)을 계산하고 표시하는 로직을 추가했습니다.
    - 상세 답변 내역과 전문가 분석 코멘트 섹션을 추가했습니다.
- **사용자 경험(UX) 개선**: 사용자의 요청에 따라, 이전 문항에 답변해야만 다음 문항이 활성화되는 순차적 답변 기능을 JavaScript로 구현했습니다.
- **오류 수정**:
    - **인코딩 오류**: CSV 파일 읽기 시 발생한 `'cp949' codec` 오류를 `'utf-8'`로 변경하여 해결했습니다.
    - **키(Key) 오류**: CSV의 열 이름(Column)이 소문자(`level0`)가 아닌 대문자(`Level0`)로 되어 있어 발생한 오류를 수정했습니다.
    - **템플릿 오류**: HTML 템플릿의 반복문에서 발생한 `'loop.parent'` 관련 오류를 변수 할당 방식으로 우회하여 해결했습니다.
    - **Excel 저장 오류**: `.xls` 형식 저장 시 발생한 `ValueError`를 최신 형식인 `.xlsx`로 변경하고, 관련 로직을 수정하여 해결했습니다.

### 4. 실행 파일 패키징

- **PyInstaller 도입**: 사용자가 파이썬 설치 없이도 프로그램을 사용할 수 있도록 PyInstaller를 사용하여 `.exe` 실행 파일 빌드를 진행했습니다.
- **자동 실행 기능**: `.exe` 파일 실행 시, 자동으로 웹 브라우저가 열리며 `http://127.0.0.1:5000` 주소로 접속되는 기능을 `webbrowser` 모듈을 사용하여 구현했습니다.
- **경로 문제 해결**: 실행 파일 환경에서 데이터 파일(`*.csv`, `templates` 폴더)을 찾지 못해 발생한 `500 Internal Server Error`를 `sys._MEIPASS`를 활용한 `resource_path` 함수를 구현하여 해결했습니다.
- **빌드 오류 해결**: 실행 중인 프로세스로 인해 파일 접근이 거부되는 `PermissionError`를 `taskkill` 명령어로 프로세스를 강제 종료한 후, 빌드 폴더를 삭제하는 방식으로 해결했습니다.

### 5. 프로젝트 구조화 및 문서화

- **폴더 구조 정리**: 소스 코드, 데이터, 문서 등을 분리하기 위해 `data`, `docs` 폴더를 생성하고 관련 파일을 이동하여 프로젝트 구조를 체계화했습니다.
- **문서화**:
    - `requirements.txt`: `pip freeze` 명령어를 통해 프로젝트의 의존성 목록을 생성했습니다.
    - `.gitignore`: 버전 관리에 불필요한 파일(빌드 결과물, 로그 등)을 지정하는 파일을 생성했습니다.
    - `README.md`: 프로젝트의 개요, 기능, 사용법, 개발 환경 설정, 빌드 방법 등을 상세히 기술한 최종 문서를 작성했습니다.

---

이 문서는 현재까지의 대화 내용을 요약한 것입니다. 앞으로의 대화 내용도 요청하시면 추가로 기록해 드리겠습니다.
